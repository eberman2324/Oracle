-- first change rman settings


rmnac

RMAN> show all;

RMAN configuration parameters for database with db_unique_name HEPYSTS_XHEPYDBW21S are:
CONFIGURE RETENTION POLICY TO RECOVERY WINDOW OF 14 DAYS;
CONFIGURE BACKUP OPTIMIZATION OFF; # default
	CONFIGURE DEFAULT DEVICE TYPE TO DISK;
CONFIGURE CONTROLFILE AUTOBACKUP ON;
	CONFIGURE CONTROLFILE AUTOBACKUP FORMAT FOR DEVICE TYPE DISK TO '/exportfs/healthedgefs1vv0/data/HEPYSTS/%F';
CONFIGURE CONTROLFILE AUTOBACKUP FORMAT FOR DEVICE TYPE 'SBT_TAPE' TO '%F';
CONFIGURE DEVICE TYPE 'SBT_TAPE' PARALLELISM 6 BACKUP TYPE TO BACKUPSET;
	CONFIGURE DEVICE TYPE DISK PARALLELISM 4 BACKUP TYPE TO COMPRESSED BACKUPSET;
CONFIGURE DATAFILE BACKUP COPIES FOR DEVICE TYPE SBT_TAPE TO 1; # default
CONFIGURE DATAFILE BACKUP COPIES FOR DEVICE TYPE DISK TO 1; # default
CONFIGURE ARCHIVELOG BACKUP COPIES FOR DEVICE TYPE SBT_TAPE TO 1; # default
CONFIGURE ARCHIVELOG BACKUP COPIES FOR DEVICE TYPE DISK TO 1; # default
CONFIGURE CHANNEL DEVICE TYPE 'SBT_TAPE' PARMS  'ENV=(TDPO_OPTFILE=/home/oracle/tdpoopt/tdpo.HEPYSTS.opt)';
CONFIGURE CHANNEL 2 DEVICE TYPE 'SBT_TAPE' PARMS  'ENV=(TDPO_OPTFILE=/home/oracle/tdpoopt/tdpo.HEPYSTS.opt)';
	CONFIGURE CHANNEL DEVICE TYPE DISK MAXPIECESIZE 100 G FORMAT   '/exportfs/healthedgefs1vv0/data/HEPYSTS/bkp_df%t_s%s_p%p';
CONFIGURE MAXSETSIZE TO UNLIMITED; # default
CONFIGURE ENCRYPTION FOR DATABASE OFF; # default
CONFIGURE ENCRYPTION ALGORITHM 'AES128'; # default
CONFIGURE COMPRESSION ALGORITHM 'BASIC' AS OF RELEASE 'DEFAULT' OPTIMIZE FOR LOAD TRUE ; # default
CONFIGURE RMAN OUTPUT TO KEEP FOR 7 DAYS; # default
CONFIGURE ARCHIVELOG DELETION POLICY TO BACKED UP 1 TIMES TO 'SBT_TAPE';
	CONFIGURE SNAPSHOT CONTROLFILE NAME TO '/exportfs/healthedgefs1vv0/data/HEPYSTS/snapcf_HEPYSTS.f';


on HEPYSTS box

locate backup_hepysts_disk.ksh

cd /home/oracle/tls/rman/disk_backup

--cront or nonup
/backup_hepysts_disk.ksh HEPYSTS backup_hepysts_disk.rman



******** HEPYQA2 example ***********

cd /home/oracle/tls/rman/disk_backup

view backup_hepyqa2_disk.ksh

-- TO DISK
CONFIGURE RETENTION POLICY TO RECOVERY WINDOW OF 90 DAYS;
CONFIGURE DEFAULT DEVICE TYPE TO DISK;
CONFIGURE DEVICE TYPE DISK PARALLELISM 4 BACKUP TYPE TO COMPRESSED BACKUPSET;
CONFIGURE CHANNEL DEVICE TYPE DISK MAXPIECESIZE 100G FORMAT '/exportfs/healthedgefs1vv0/data/HEPYQA2/bkp_df%t_s%s_p%p';
CONFIGURE CONTROLFILE AUTOBACKUP ON;
CONFIGURE CONTROLFILE AUTOBACKUP FORMAT FOR DEVICE TYPE DISK TO '/exportfs/healthedgefs1vv0/data/HEPYQA2/%F';
CONFIGURE SNAPSHOT CONTROLFILE NAME TO '/exportfs/healthedgefs1vv0/data/HEPYQA2/snapcf_HEPYQA2.f';
CONFIGURE ARCHIVELOG DELETION POLICY TO BACKED UP 10 TIMES TO DISK;


-- back to TAPE
CONFIGURE RETENTION POLICY TO RECOVERY WINDOW OF 14 DAYS;
CONFIGURE DEFAULT DEVICE TYPE TO 'SBT_TAPE';
CONFIGURE CONTROLFILE AUTOBACKUP ON;
CONFIGURE CONTROLFILE AUTOBACKUP FORMAT FOR DEVICE TYPE DISK TO '%F';
CONFIGURE CONTROLFILE AUTOBACKUP FORMAT FOR DEVICE TYPE 'SBT_TAPE' TO '%F';
CONFIGURE DEVICE TYPE 'SBT_TAPE' PARALLELISM 4 BACKUP TYPE TO BACKUPSET;
CONFIGURE DEVICE TYPE DISK PARALLELISM 1 BACKUP TYPE TO COMPRESSED BACKUPSET;
CONFIGURE CHANNEL DEVICE TYPE 'SBT_TAPE' PARMS  'ENV=(TDPO_OPTFILE=/home/oracle/tdpoopt/tdpo.HEPYQA2.opt)';
CONFIGURE CHANNEL 2 DEVICE TYPE 'SBT_TAPE' PARMS  'ENV=(TDPO_OPTFILE=/home/oracle/tdpoopt/tdpo.HEPYQA2.opt)';
CONFIGURE ARCHIVELOG DELETION POLICY TO BACKED UP 1 TIMES TO 'SBT_TAPE';
CONFIGURE SNAPSHOT CONTROLFILE NAME TO '/orahome/u01/app/oracle/product/12.1.0.2.200414/db_1/dbs/snapcf_HEPYQA2.f';


view backup_hepyqa2_disk.rman

spool log to backup_hepyqa2_2020_10_15.out;

select to_char(sysdate, 'YYYY-MM-DD HH24:MI:SS') "Start Time" from dual;

show all;

run
{
 BACKUP CHECK LOGICAL DATABASE PLUS ARCHIVELOG;
 BACKUP ARCHIVELOG ALL;
}

# Below added in support of Metalink Note 1348071.1
run
{
 ALTER SYSTEM ARCHIVE LOG CURRENT;
 BACKUP ARCHIVELOG ALL;
}

select to_char(sysdate, 'YYYY-MM-DD HH24:MI:SS') "End Time" from dual;

spool log off;




***** HEPYQA3 *******

cd /home/oracle/tls/rman/disk_backup

Request Mike Giordano to mount NFS 

1. Before starting backup suspend OEM Archivelog job

2. Save original tape rman settings

vi configure_hepyqa3_tape.rman

CONFIGURE RETENTION POLICY TO RECOVERY WINDOW OF 14 DAYS;
CONFIGURE DEFAULT DEVICE TYPE TO 'SBT_TAPE';
CONFIGURE CONTROLFILE AUTOBACKUP ON;
CONFIGURE CONTROLFILE AUTOBACKUP FORMAT FOR DEVICE TYPE DISK TO '%F';
CONFIGURE CONTROLFILE AUTOBACKUP FORMAT FOR DEVICE TYPE 'SBT_TAPE' TO '%F';
CONFIGURE DEVICE TYPE 'SBT_TAPE' PARALLELISM 6 BACKUP TYPE TO BACKUPSET;
CONFIGURE DEVICE TYPE DISK PARALLELISM 1 BACKUP TYPE TO COMPRESSED BACKUPSET;
CONFIGURE CHANNEL DEVICE TYPE 'SBT_TAPE' PARMS 'ENV=(TDPO_OPTFILE=/home/oracle/tdpoopt/tdpo.HEPYQA3.opt)';
CONFIGURE CHANNEL 2 DEVICE TYPE 'SBT_TAPE' PARMS 'ENV=(TDPO_OPTFILE=/home/oracle/tdpoopt/tdpo.HEPYQA3.opt)';
CONFIGURE ARCHIVELOG DELETION POLICY TO BACKED UP 1 TIMES TO 'SBT_TAPE';
CONFIGURE SNAPSHOT CONTROLFILE NAME TO '/orahome/u01/app/oracle/product/19.11.0/db_1/dbs/snapcf_HEPYQA3.f'; # default


3. Prep disk rman settings that needs to be run before backup starts

vi configure_hepyqa3_disk.rman

CONFIGURE DEFAULT DEVICE TYPE TO DISK;
CONFIGURE DEVICE TYPE DISK PARALLELISM 6 BACKUP TYPE TO COMPRESSED BACKUPSET;
CONFIGURE CHANNEL DEVICE TYPE DISK MAXPIECESIZE 100G FORMAT '/exportfs/healthedgefs/HEPYQA3/bkp_df%t_s%s_p%p'
CONFIGURE CONTROLFILE AUTOBACKUP ON;
CONFIGURE CONTROLFILE AUTOBACKUP FORMAT FOR DEVICE TYPE DISK TO '/exportfs/healthedgefs/HEPYQA3/%F';
CONFIGURE SNAPSHOT CONTROLFILE NAME TO '/exportfs/healthedgefs/HEPYQA3/snapcf_HEPYQA3.f';

rmanc

@configure_hepyqa3_disk.rman

4. Run with nohup


--cront or nonup
nohup backup_hepyqa3_disk.ksh HEPYQA3 backup_hepyqa3_disk.rman

ps -ef |grep -i backup_hepyqa3_disk.ksh




************* HEPYMASK 04/2022***********

cd /exportfs/healthedgefs1vv0/data/HEPYMASK_KEEP

-- Move to archivelog  mode
shutdown immediate;
startup mount;
alter database archivelog;
alter database open;
archive log list;


1. Before starting backup suspend OEM Archivelog job

2. Save original tape rman settings
rmanc

SPOOL LOG TO 'showall.txt';
show all;
SPOOL LOG OFF;

/exportfs/healthedgefs1vv0/data/HEPYMASK_KEEP/showall.txt

3. Prep disk rman settings that needs to be run before backup starts

cd $HOME/tls/rman/disk_backup

vi configure_hepymask_disk.rman

CONFIGURE DEFAULT DEVICE TYPE TO DISK;
CONFIGURE DEVICE TYPE DISK PARALLELISM 6 BACKUP TYPE TO COMPRESSED BACKUPSET;
CONFIGURE CHANNEL DEVICE TYPE DISK MAXPIECESIZE 100G FORMAT '/exportfs/healthedgefs1vv0/data/HEPYMASK/bkp_df%t_s%s_p%p'
CONFIGURE CONTROLFILE AUTOBACKUP ON;
CONFIGURE CONTROLFILE AUTOBACKUP FORMAT FOR DEVICE TYPE DISK TO '/exportfs/healthedgefs1vv0/data/HEPYMASK/%F';
CONFIGURE SNAPSHOT CONTROLFILE NAME TO '/exportfs/healthedgefs1vv0/data/HEPYMASK/snapcf_HEPYMASK.f';

rmanc

@configure_hepymask_disk.rman


4. Run with nohup

cd $HOME/tls/rman/disk_backup
--cront or nonup
nohup backup_hepymask_disk.ksh HEPYMASK backup_hepymask_disk.rman

ps -ef |grep -i backup_hepymask_disk.ksh

!! per Tom's advise if get archivelog backup errors at the end . Run manually below

BACKUP ARCHIVELOG ALL;

ALTER SYSTEM ARCHIVE LOG CURRENT;
BACKUP ARCHIVELOG ALL;


*** Next step send backupsets to HRP
xhepydbm21q.aetna.com (oracle) HEPYMASK::/home/oracle/tls/transfer

nohup send_files_to_healthedge.sh &

ps -ef | grep send_files_to_healthedge.sh

To monitor

cd /home/oracle/tls/transfer/logs


Got following error to fix move files that already completed and restart

Sending file bkp_df1101250987_s2071_p2 to 207.211.13.68 at Thu Apr 14 15:47:05 EDT 2022
Connected to 207.211.13.68.
sftp> cd /AetnaData
sftp> put bkp_df1101250987_s2071_p2
Uploading bkp_df1101250987_s2071_p2 to /AetnaData/bkp_df1101250987_s2071_p2
Killed by signal 15.
File bkp_df1101250987_s2071_p2 failed to transfer, ending the process at Thu Apr 14 16:10:28 EDT 2022


mv test.txt /exportfs/healthedgefs1vv0/data/HEPYMASK_KEEP/test.txt


mv bkp_df1101250969_s2065_p1 /exportfs/healthedgefs1vv0/data/HEPYMASK_KEEP/bkp_df1101250969_s2065_p1

mv bkp_df1101250969_s2066_p1 /exportfs/healthedgefs1vv0/data/HEPYMASK_KEEP/bkp_df1101250969_s2066_p1

mv bkp_df1101250969_s2067_p1 /exportfs/healthedgefs1vv0/data/HEPYMASK_KEEP/bkp_df1101250969_s2067_p1

mv bkp_df1101250969_s2068_p1 /exportfs/healthedgefs1vv0/data/HEPYMASK_KEEP/bkp_df1101250969_s2068_p1

mv bkp_df1101250969_s2069_p1 /exportfs/healthedgefs1vv0/data/HEPYMASK_KEEP/bkp_df1101250969_s2069_p1

mv bkp_df1101250969_s2070_p1 /exportfs/healthedgefs1vv0/data/HEPYMASK_KEEP/bkp_df1101250969_s2070_p1

mv bkp_df1101250987_s2071_p1 /exportfs/healthedgefs1vv0/data/HEPYMASK_KEEP/bkp_df1101250987_s2071_p1

mv bkp_df1101250987_s2071_p10 /exportfs/healthedgefs1vv0/data/HEPYMASK_KEEP/bkp_df1101250987_s2071_p10

mv bkp_df1101250987_s2071_p11 /exportfs/healthedgefs1vv0/data/HEPYMASK_KEEP/bkp_df1101250987_s2071_p11

mv bkp_df1101250987_s2071_p12 /exportfs/healthedgefs1vv0/data/HEPYMASK_KEEP/bkp_df1101250987_s2071_p12

mv bkp_df1101250987_s2071_p13 /exportfs/healthedgefs1vv0/data/HEPYMASK_KEEP/bkp_df1101250987_s2071_p13

mv bkp_df1101250987_s2071_p14 /exportfs/healthedgefs1vv0/data/HEPYMASK_KEEP/bkp_df1101250987_s2071_p14

mv bkp_df1101250987_s2071_p15 /exportfs/healthedgefs1vv0/data/HEPYMASK_KEEP/bkp_df1101250987_s2071_p15

mv bkp_df1101250987_s2071_p16 /exportfs/healthedgefs1vv0/data/HEPYMASK_KEEP/bkp_df1101250987_s2071_p16

mv bkp_df1101250987_s2071_p17 /exportfs/healthedgefs1vv0/data/HEPYMASK_KEEP/bkp_df1101250987_s2071_p17

mv bkp_df1101250987_s2071_p18 /exportfs/healthedgefs1vv0/data/HEPYMASK_KEEP/bkp_df1101250987_s2071_p18

mv bkp_df1101250987_s2071_p19 /exportfs/healthedgefs1vv0/data/HEPYMASK_KEEP/bkp_df1101250987_s2071_p19
____

mv bkp_df1101250987_s2071_p2 /exportfs/healthedgefs1vv0/data/HEPYMASK_KEEP/bkp_df1101250987_s2071_p2

mv bkp_df1101250987_s2071_p20 /exportfs/healthedgefs1vv0/data/HEPYMASK_KEEP/kp_df1101250987_s2071_p20

mv bkp_df1101250987_s2071_p21 /exportfs/healthedgefs1vv0/data/HEPYMASK_KEEP/bkp_df1101250987_s2071_p21

mv bkp_df1101250987_s2071_p22 /exportfs/healthedgefs1vv0/data/HEPYMASK_KEEP/bkp_df1101250987_s2071_p22

mv bkp_df1101250987_s2071_p23 /exportfs/healthedgefs1vv0/data/HEPYMASK_KEEP/bkp_df1101250987_s2071_p23

mv bkp_df1101250987_s2071_p24 /exportfs/healthedgefs1vv0/data/HEPYMASK_KEEP/bkp_df1101250987_s2071_p24

mv bkp_df1101250987_s2071_p25 /exportfs/healthedgefs1vv0/data/HEPYMASK_KEEP/bkp_df1101250987_s2071_p25

mv bkp_df1101250987_s2071_p26 /exportfs/healthedgefs1vv0/data/HEPYMASK_KEEP/bkp_df1101250987_s2071_p26

mv bkp_df1101250987_s2071_p27 /exportfs/healthedgefs1vv0/data/HEPYMASK_KEEP/bkp_df1101250987_s2071_p27

mv bkp_df1101250987_s2071_p28 /exportfs/healthedgefs1vv0/data/HEPYMASK_KEEP/bkp_df1101250987_s2071_p28

mv bkp_df1101250987_s2071_p29 /exportfs/healthedgefs1vv0/data/HEPYMASK_KEEP/bkp_df1101250987_s2071_p29

mv bkp_df1101250987_s2071_p3 /exportfs/healthedgefs1vv0/data/HEPYMASK_KEEP/bkp_df1101250987_s2071_p3

mv bkp_df1101250987_s2071_p4 /exportfs/healthedgefs1vv0/data/HEPYMASK_KEEP/bkp_df1101250987_s2071_p4

mv bkp_df1101250987_s2071_p5 /exportfs/healthedgefs1vv0/data/HEPYMASK_KEEP/bkp_df1101250987_s2071_p5

mv bkp_df1101250987_s2071_p6 /exportfs/healthedgefs1vv0/data/HEPYMASK_KEEP/bkp_df1101250987_s2071_p6

mv bkp_df1101250987_s2071_p7 /exportfs/healthedgefs1vv0/data/HEPYMASK_KEEP/bkp_df1101250987_s2071_p7

mv bkp_df1101250987_s2071_p8 /exportfs/healthedgefs1vv0/data/HEPYMASK_KEEP/bkp_df1101250987_s2071_p8

mv bkp_df1101250987_s2071_p9 /exportfs/healthedgefs1vv0/data/HEPYMASK_KEEP/bkp_df1101250987_s2071_p9

mv bkp_df1101250987_s2072_p1 /exportfs/healthedgefs1vv0/data/HEPYMASK_KEEP/bkp_df1101250987_s2072_p1

mv bkp_df1101250987_s2072_p10 /exportfs/healthedgefs1vv0/data/HEPYMASK_KEEP/bkp_df1101250987_s2072_p10

mv bkp_df1101250987_s2072_p11 /exportfs/healthedgefs1vv0/data/HEPYMASK_KEEP/bkp_df1101250987_s2072_p11

mv bkp_df1101250987_s2072_p12 /exportfs/healthedgefs1vv0/data/HEPYMASK_KEEP/bkp_df1101250987_s2072_p12

mv bkp_df1101250987_s2072_p13 /exportfs/healthedgefs1vv0/data/HEPYMASK_KEEP/bkp_df1101250987_s2072_p13

mv bkp_df1101250987_s2072_p14 /exportfs/healthedgefs1vv0/data/HEPYMASK_KEEP/bkp_df1101250987_s2072_p14

mv bkp_df1101250987_s2072_p15 /exportfs/healthedgefs1vv0/data/HEPYMASK_KEEP/bkp_df1101250987_s2072_p15

mv bkp_df1101250987_s2072_p16 /exportfs/healthedgefs1vv0/data/HEPYMASK_KEEP/bkp_df1101250987_s2072_p16

mv bkp_df1101250987_s2072_p17 /exportfs/healthedgefs1vv0/data/HEPYMASK_KEEP/bkp_df1101250987_s2072_p17

mv bkp_df1101250987_s2072_p18 /exportfs/healthedgefs1vv0/data/HEPYMASK_KEEP/bkp_df1101250987_s2072_p18

mv bkp_df1101250987_s2072_p19 /exportfs/healthedgefs1vv0/data/HEPYMASK_KEEP/bkp_df1101250987_s2072_p19

mv bkp_df1101250987_s2072_p2 /exportfs/healthedgefs1vv0/data/HEPYMASK_KEEP/bkp_df1101250987_s2072_p2

mv bkp_df1101250987_s2072_p20 /exportfs/healthedgefs1vv0/data/HEPYMASK_KEEP/bkp_df1101250987_s2072_p20

mv bkp_df1101250987_s2072_p21 /exportfs/healthedgefs1vv0/data/HEPYMASK_KEEP/bkp_df1101250987_s2072_p21

mv bkp_df1101250987_s2072_p22 /exportfs/healthedgefs1vv0/data/HEPYMASK_KEEP/bkp_df1101250987_s2072_p22

mv bkp_df1101250987_s2072_p23 /exportfs/healthedgefs1vv0/data/HEPYMASK_KEEP/bkp_df1101250987_s2072_p23

mv bkp_df1101250987_s2072_p24 /exportfs/healthedgefs1vv0/data/HEPYMASK_KEEP/bkp_df1101250987_s2072_p24

mv bkp_df1101250987_s2072_p25 /exportfs/healthedgefs1vv0/data/HEPYMASK_KEEP/bkp_df1101250987_s2072_p25

mv bkp_df1101250987_s2072_p3 /exportfs/healthedgefs1vv0/data/HEPYMASK_KEEP/bkp_df1101250987_s2072_p3


************* HEPYMASK latest backup steps***********

1. Remove old backups from 


-- new ---

cd /oracle/hrpmaskbackup/data/HEPYMASK_KEEP

rmanc

SPOOL LOG TO 'showall_Nov2024.txt';
show all;
SPOOL LOG OFF;


cd /oracle/hrpmaskbackup/data/HEPYMASK

-- Note Size of last backup per May 2024
HEPYMASK> du -h
31 TB


rm -f bkp*
rm -f c-*
rm -f snap*





-- Move to archivelog  mode ( if necessary)
shutdown immediate;
startup mount;
alter database archivelog;
alter database open;
archive log list;


1. Before starting backup suspend OEM Archivelog job and Level 0 job if not already suspended for HEPYMASK







3. Prep disk rman settings that needs to be run before backup starts. Script should be already in place. Just double check

cd $HOME/tls/rman/disk_backup

vi configure_hepymask_disk.rman

CONFIGURE RETENTION POLICY TO RECOVERY WINDOW OF 60 DAYS;
CONFIGURE DEFAULT DEVICE TYPE TO DISK;
CONFIGURE DEVICE TYPE DISK PARALLELISM 6 BACKUP TYPE TO COMPRESSED BACKUPSET;
CONFIGURE CHANNEL DEVICE TYPE DISK FORMAT '/oracle/hrpmaskbackup/data/HEPYMASK/bkp_df%t_s%s_p%p';
CONFIGURE CONTROLFILE AUTOBACKUP ON;
CONFIGURE CONTROLFILE AUTOBACKUP FORMAT FOR DEVICE TYPE DISK TO '/oracle/hrpmaskbackup/data/HEPYMASK/%F
CONFIGURE SNAPSHOT CONTROLFILE NAME TO '/oracle/hrpmaskbackup/data/HEPYMASK/snapcf_HEPYMASK.f';
CONFIGURE ARCHIVELOG DELETION POLICY TO BACKED UP 10 TIMES TO DISK;


rmanc

@configure_hepymask_disk.rman


4. Prep backup script and run. Script should be already in place. Just double check



vi backup_hepymask_disk_he_commands.rman

-- Remove CHECK LOGICAL to prevent failre due to corruption that still exist
run
{
BACKUP DATABASE SECTION SIZE 400G PLUS ARCHIVELOG;
}
 
# Below added in support of Metalink Note 1348071.1
run
{
ALTER SYSTEM ARCHIVE LOG CURRENT;
BACKUP ARCHIVELOG ALL;
}

run
{
BACKUP CURRENT CONTROLFILE;
}



cd $HOME/tls/rman/disk_backup

ps -ef |grep -i backup_hepymask_disk.ksh

--cront or nonup
nohup backup_hepymask_disk.ksh HEPYMASK backup_hepymask_disk_he_commands.rman



*** Next step send backupsets to HRP
xhepydbm21q.aetna.com (oracle) HEPYMASK::/home/oracle/tls/transfer

!!!First conduct handshake_test

sftp -oPORT=2223 aetna_general@207.211.13.68
ls
df -h 

handshake_test.sh
 

!!!!if above completed and if it shows old backup still sitting on HealthEdge ftp server. Ask them to remove it. 
    Check who much space our backup took and tell HE to make sure they can accomadate that. They nornally have to add more space on their end.

!!! Once Tu or somebody from HE confirms that everthing in place. You can kick off FTP


10 12 * * * /home/oracle/tls/transfer/send_files_to_healthedge.sh

or

nohup send_files_to_healthedge.sh &

ps -ef | grep send_files_to_healthedge.sh

To monitor

cd /home/oracle/tls/transfer/logs


Got following error to fix move files that already completed and restart




Sending file bkp_df1106933288_s2927_p8 to 207.211.13.68 at Tue Jun 14 06:34:16 EDT 2022
Connected to 207.211.13.68.
sftp> cd /AetnaData
sftp> put bkp_df1106933288_s2927_p8
Uploading bkp_df1106933288_s2927_p8 to /AetnaData/bkp_df1106933288_s2927_p8
Killed by signal 15.
File bkp_df1106933288_s2927_p8 failed to transfer, ending the process at Tue Jun 14 06:43:44 EDT 2022



Sending file bkp_df1106933288_s2929_p5 to 207.211.13.68 at Tue Jun 14 16:00:32 EDT 2022
Connected to 207.211.13.68.
sftp> cd /AetnaData
sftp> put bkp_df1106933288_s2929_p5
Uploading bkp_df1106933288_s2929_p5 to /AetnaData/bkp_df1106933288_s2929_p5
Killed by signal 15.
File bkp_df1106933288_s2929_p5 failed to transfer, ending the process at Tue Jun 14 16:00:45 EDT 2022


Sending file bkp_df1106933288_s2930_p2 to 207.211.13.68 at Tue Jun 14 20:58:06 EDT 2022
Connected to 207.211.13.68.
sftp> cd /AetnaData
sftp> put bkp_df1106933288_s2930_p2
Uploading bkp_df1106933288_s2930_p2 to /AetnaData/bkp_df1106933288_s2930_p2
Couldn't write to remote file "/AetnaData/bkp_df1106933288_s2930_p2": Failure
Successfully transferred file bkp_df1106933288_s2930_p2 at Tue Jun 14 21:11:11 EDT 2022


mv bkp_df1106933288_s2930_p2 /exportfs/healthedgefs1vv0/data/HEPYMASK_KEEP/bkp_df1106933288_s2930_p2
mv snapcf_HEPYMASK.f /exportfs/healthedgefs1vv0/data/HEPYMASK_KEEP/snapcf_HEPYMASK.f


cp /oracle/hrpmaskbackup/data/HEPYMASK/bkp_df1176466239_s4293_p1 /oracle/hrpmaskbackup/data/HEPYMASK_KEEP/bkp_df1176466239_s4293_p1

vi showall.rman

Spooling started in log file: showall.txt

Recovery Manager19.18.0.0.0

RMAN> 
RMAN configuration parameters for database with db_unique_name HEPYMASK_XHEPYDBM21Q are:
CONFIGURE RETENTION POLICY TO RECOVERY WINDOW OF 30 DAYS;
CONFIGURE BACKUP OPTIMIZATION OFF; # default
CONFIGURE DEFAULT DEVICE TYPE TO 'SBT_TAPE';
CONFIGURE CONTROLFILE AUTOBACKUP ON;
CONFIGURE CONTROLFILE AUTOBACKUP FORMAT FOR DEVICE TYPE DISK TO '%F';
CONFIGURE CONTROLFILE AUTOBACKUP FORMAT FOR DEVICE TYPE 'SBT_TAPE' TO '%F';
CONFIGURE DEVICE TYPE 'SBT_TAPE' PARALLELISM 8 BACKUP TYPE TO BACKUPSET;
CONFIGURE DEVICE TYPE DISK PARALLELISM 1 BACKUP TYPE TO COMPRESSED BACKUPSET;
CONFIGURE DATAFILE BACKUP COPIES FOR DEVICE TYPE SBT_TAPE TO 1; # default
CONFIGURE DATAFILE BACKUP COPIES FOR DEVICE TYPE DISK TO 1; # default
CONFIGURE ARCHIVELOG BACKUP COPIES FOR DEVICE TYPE SBT_TAPE TO 1; # default
CONFIGURE ARCHIVELOG BACKUP COPIES FOR DEVICE TYPE DISK TO 1; # default
CONFIGURE CHANNEL DEVICE TYPE 'SBT_TAPE' PARMS  'BLKSIZE=1048576,SBT_LIBRARY=/orahome/u01/app/ddboost/lib/libddobk.so,ENV=(STORAGE_UNIT=/ora_dev_boost3540/xhepydbm21q,BACKUP_HOST=midpdd3540_lf2,ORACLE_HOME=/orahome/u01/app/oracle/admin/HEPYMASK/oracle_home)' FORMAT   './%d/bk_%d_%I_%T/%U';
CONFIGURE MAXSETSIZE TO UNLIMITED; # default
CONFIGURE ENCRYPTION FOR DATABASE OFF; # default
CONFIGURE ENCRYPTION ALGORITHM 'AES128'; # default
CONFIGURE COMPRESSION ALGORITHM 'BASIC' AS OF RELEASE 'DEFAULT' OPTIMIZE FOR LOAD TRUE ; # default
CONFIGURE RMAN OUTPUT TO KEEP FOR 7 DAYS; # default
CONFIGURE ARCHIVELOG DELETION POLICY TO BACKED UP 1 TIMES TO 'SBT_TAPE';
CONFIGURE SNAPSHOT CONTROLFILE NAME TO '/orahome/u01/app/oracle/product/19.18.0/db_1/dbs/snapcf_HEPYMASK.f'; # default

RMAN> 


