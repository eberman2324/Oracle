---->Administrative privilege assignment

--->One or more unauthorized administrative privileges have been granted to DBA grantees.

Grants of admin privileges: 

Grantee = A170895 : Granted_Role = DBA 
Grantee = A229515 : Granted_Role = DBA 
Grantee = A236120 : Granted_Role = DBA 
Grantee = A246831 : Granted_Role = DBA 
Grantee = A568125 : Granted_Role = DBA 
Grantee = A665751 : Granted_Role = DBA 
Grantee = A707000 : Granted_Role = DBA 
Grantee = A740531 : Granted_Role = DBA 
Grantee = A744624 : Granted_Role = DBA 
Grantee = N025774 : Granted_Role = DBA 
Grantee = N217924 : Granted_Role = DBA 
Grantee = OPS$ORACLE : Granted_Role = DBA

Restrict DBA roles to use for DBA functions. Revoke any privileges outside of the DBA role and the UNLIMITED TABLESPACE privilege. 



----->SEC_CASE_SENSITIVE_LOGON is disabled.

You should enable SEC_CASE_SENSITIVE_LOGON.


---> Limit External User Login Capability
--->One or more users has the EXTERNAL authentication type.

UserName = OPS$BATCHMGR 
UserName = OPS$ORACLE 
UserName = OPS$DPPXFNCL

We recommend disabling or limiting then use of external type authentication users.


---->Limit Roles Granted With ADMIN Option
---->Unauthorized users or roles have been granted with ADMIN_OPTION. Including 1 items present in exceptions group.

Grantee = PSADMIN : Granted_Role = EXP_FULL_DATABASE : Admin_option = YES 
Grantee = PSADMIN : Granted_Role = IMP_FULL_DATABASE : Admin_option = YES 
Grantee = PSADMIN : Granted_Role = RESOURCE : Admin_option = YES

We recommend you revoke the role privilege from unauthorized grantees.


---->Limit to Grant System Privileges With ADMIN Option
---->Unauthorized grantee has been granted system privilege with ADMIN_OPTION.

Grantee = PSADMIN : Privilege = ADMINISTER RESOURCE MANAGER : Admin_Option = YES

We recommend you revoke privileges with WITH_ADMIN option from unauthorized grantees.



---->No Authorization To ANY Keyword Privileges
---->Unauthorized users or roles have been granted with ANY keyword privileges. Including 14 items present in exceptions group.

GRANTEE = DPADMIN : PRIVILEGE = ANALYZE ANY 
GRANTEE = ICR_AUDIT : PRIVILEGE = SELECT ANY DICTIONARY 
GRANTEE = SYSADM : PRIVILEGE = SELECT ANY DICTIONARY


We recommend you revoke any privileges with ANY keyword from unauthorized grantees.


--->No Authorization To CREATE PROCEDURE Privilege
--->'CREATE PROCEDURE' privilege has been granted to unauthorized users.

Grantee = BENENG : Privilege = CREATE PROCEDURE 
Grantee = PSADMIN : Privilege = CREATE PROCEDURE 
Grantee = ORATIVOLI : Privilege = CREATE PROCEDURE



We recommend you revoke the CREATE PROCEDURE privilege from unauthorized grantees. 


---->Oracle default tablespace assignment
---->One or more non-management users has been assigned the SYSTEM tablespace as his/her default or temporary tablespace.

Bad default tablespace assignments: 
ORACLE_OCM 
SYSDG 
AUDSYS 
GSMUSER 
SYSBACKUP 
SYSKM 
XS$NULL 
GSMCATUSER 
OPS$ORACLE

You should review users' default and temporary tablespace assignments, changing them as necessary.  Create and dedicate tablespaces to support only on application.



---->OS_AUTHENT_PREFIX Is Not OPS$
---->Parameter: 'OS_AUTHENT_PREFIX' is 'ops$'.

OS_AUTHENT_PREFIX is set to the default value. 
We recommend changing this parameter to a value different tan the default value. Leaving the default value compromises the security of your DB.

1)	If you have a finding for OS_AUTHENT_PREFIX Is Not OPS$, the standard setting is now ‘ext$’. 
 Please change your parameter setting from ‘ops$’ to ‘ext$’ for remediation. 
 This parameter is not dynamic and will take effect the next time the database is bounced 
(You can place the CAE item in Remediation in Progress status with an ETA for when the database will be bounced).


************************************************************
. ~/.profile

DPDEVUG


SQL> show parameter OS_AUTHENT_PREFIX

NAME                                 TYPE        VALUE
------------------------------------ ----------- -------
os_authent_prefix                    string      ops$

create pfile from spfile;

SQL>

cd $ORACLE_HOME/dbs

sqlplus / as sysdba

shutdown immediate

exit

vi initDPDEVUG.ora

os_authent_prefix = 'ext$'


rm -f spfileDPDEVUG.ora

sqlplus / as sysdba

startup

SQL> show parameter OS_AUTHENT_PREFIX

NAME                                 TYPE        VALUE
------------------------------------ ----------- --------
os_authent_prefix                    string      ext$

create spfile from pfile;

shutdown immediate

startup
exit


CREATE USER ext$BATCHMGR IDENTIFIED EXTERNALLY
    DEFAULT TABLESPACE USERS
    TEMPORARY TABLESPACE TEMP
    PROFILE STANDARD
    ACCOUNT UNLOCK
/
GRANT PSOPSBATCHMGR TO ext$BATCHMGR
/
GRANT PSUSER TO ext$BATCHMGR
/
ALTER USER ext$BATCHMGR DEFAULT ROLE PSOPSBATCHMGR,
                                     PSUSER
/


CREATE USER ext$DPPXFNCL IDENTIFIED EXTERNALLY
    DEFAULT TABLESPACE USERS
    TEMPORARY TABLESPACE TEMP
    PROFILE STANDARD
    ACCOUNT UNLOCK
/
GRANT PSOPSBATCHMGR TO ext$DPPXFNCL
/
GRANT PSUSER TO ext$DPPXFNCL
/
ALTER USER ext$DPPXFNCL DEFAULT ROLE PSOPSBATCHMGR,
                                     PSUSER
/


CREATE USER ext$ORACLE IDENTIFIED EXTERNALLY
    DEFAULT TABLESPACE USERS
    TEMPORARY TABLESPACE TEMP
    PROFILE DEFAULT
    ACCOUNT UNLOCK
/
GRANT "CONNECT" TO ext$ORACLE
/
GRANT DBA TO ext$ORACLE
/
GRANT PSOPSBATCHMGR TO ext$ORACLE WITH ADMIN OPTION
/
GRANT PSQA TO ext$ORACLE WITH ADMIN OPTION
/
GRANT SUPPORTTEST TO ext$ORACLE WITH ADMIN OPTION
/
ALTER USER ext$ORACLE DEFAULT ROLE "CONNECT",
                                   DBA,
                                   PSOPSBATCHMGR,
                                   PSQA,
                                   SUPPORTTEST
/
GRANT UNLIMITED TABLESPACE TO ext$ORACLE
/


ALTER USER OPS$ORACLE
 ACCOUNT LOCK

/
ALTER USER OPS$DPPXFNCL
 ACCOUNT LOCK

/
ALTER USER OPS$BATCHMGR
 ACCOUNT LOCK


/






REVOKE ANALYZE ANY FROM DPADMIN
/                          
REVOKE SELECT ANY DICTIONARY FROM SYSADM

/

*******************************
. ~/.profile

DPDEV92


SQL> show parameter OS_AUTHENT_PREFIX

NAME                                 TYPE        VALUE
------------------------------------ ----------- -------
os_authent_prefix                    string      ops$

create pfile from spfile;

SQL>

cd $ORACLE_HOME/dbs

sqlplus / as sysdba

shutdown immediate

exit

vi initDPDEV92.ora

os_authent_prefix = 'ext$'


rm -f spfileDPDEV92.ora

sqlplus / as sysdba

startup

SQL> show parameter OS_AUTHENT_PREFIX

NAME                                 TYPE        VALUE
------------------------------------ ----------- --------
os_authent_prefix                    string      ext$

create spfile from pfile;

shutdown immediate

startup
exit


CREATE USER ext$BATCHMGR IDENTIFIED EXTERNALLY
    DEFAULT TABLESPACE USERS
    TEMPORARY TABLESPACE TEMP
    PROFILE TRUSTED_ID_NO_EXPIRE
    ACCOUNT UNLOCK
/
GRANT PSOPSBATCHMGR TO ext$BATCHMGR
/
GRANT PSUSER TO ext$BATCHMGR
/
ALTER USER ext$BATCHMGR DEFAULT ROLE PSOPSBATCHMGR,
                                     PSUSER
/
CREATE USER ext$DPPXFNCL IDENTIFIED EXTERNALLY
    DEFAULT TABLESPACE USERS
    TEMPORARY TABLESPACE TEMP
    PROFILE TRUSTED_ID_NO_EXPIRE
    ACCOUNT UNLOCK
/
GRANT PSOPSBATCHMGR TO ext$DPPXFNCL
/
GRANT PSUSER TO ext$DPPXFNCL
/
ALTER USER ext$DPPXFNCL DEFAULT ROLE PSOPSBATCHMGR,
                                     PSUSER
/
CREATE USER ext$ORACLE IDENTIFIED EXTERNALLY
    DEFAULT TABLESPACE USERS
    TEMPORARY TABLESPACE TEMP
    PROFILE TRUSTED_ID_NO_EXPIRE
    ACCOUNT UNLOCK
/
GRANT "CONNECT" TO ext$ORACLE
/
GRANT DBA TO ext$ORACLE
/
ALTER USER ext$ORACLE DEFAULT ROLE "CONNECT",
                                   DBA
/
GRANT UNLIMITED TABLESPACE TO ext$ORACLE
/

ALTER USER OPS$ORACLE
 ACCOUNT LOCK

/
ALTER USER OPS$DPPXFNCL
 ACCOUNT LOCK

/
ALTER USER OPS$BATCHMGR
 ACCOUNT LOCK

/






REVOKE ANALYZE ANY FROM DPADMIN
/                          
REVOKE SELECT ANY DICTIONARY FROM SYSADM

/

*******************************
. ~/.profile

DPUAT92


SQL> show parameter OS_AUTHENT_PREFIX

NAME                                 TYPE        VALUE
------------------------------------ ----------- -------
os_authent_prefix                    string      ops$

create pfile from spfile;

SQL>

cd $ORACLE_HOME/dbs

sqlplus / as sysdba

shutdown immediate

exit

vi initDPUAT92.ora

os_authent_prefix = 'ext$'


rm -f spfileDPUAT92.ora

sqlplus / as sysdba

startup

SQL> show parameter OS_AUTHENT_PREFIX

NAME                                 TYPE        VALUE
------------------------------------ ----------- --------
os_authent_prefix                    string      ext$

create spfile from pfile;

shutdown immediate

startup
exit


CREATE USER ext$BATCHMGR IDENTIFIED EXTERNALLY
    DEFAULT TABLESPACE USERS
    TEMPORARY TABLESPACE TEMP
    PROFILE TRUSTED_ID_NO_EXPIRE
    ACCOUNT UNLOCK
/
GRANT PSOPSBATCHMGR TO ext$BATCHMGR
/
GRANT PSUSER TO ext$BATCHMGR
/
ALTER USER ext$BATCHMGR DEFAULT ROLE PSOPSBATCHMGR,
                                     PSUSER
/
CREATE USER ext$DPPXFNCL IDENTIFIED EXTERNALLY
    DEFAULT TABLESPACE USERS
    TEMPORARY TABLESPACE TEMP
    PROFILE TRUSTED_ID_NO_EXPIRE
    ACCOUNT UNLOCK
/
GRANT PSOPSBATCHMGR TO ext$DPPXFNCL
/
GRANT PSUSER TO ext$DPPXFNCL
/
ALTER USER ext$DPPXFNCL DEFAULT ROLE PSOPSBATCHMGR,
                                     PSUSER
/
CREATE USER ext$ORACLE IDENTIFIED EXTERNALLY
    DEFAULT TABLESPACE USERS
    TEMPORARY TABLESPACE TEMP
    PROFILE TRUSTED_ID_NO_EXPIRE
    ACCOUNT UNLOCK
/
GRANT "CONNECT" TO ext$ORACLE
/
GRANT DBA TO ext$ORACLE
/
ALTER USER ext$ORACLE DEFAULT ROLE "CONNECT",
                                   DBA
/
GRANT UNLIMITED TABLESPACE TO ext$ORACLE
/

ALTER USER OPS$ORACLE
 ACCOUNT LOCK

/
ALTER USER OPS$DPPXFNCL
 ACCOUNT LOCK

/
ALTER USER OPS$BATCHMGR
 ACCOUNT LOCK

/







REVOKE ANALYZE ANY FROM DPADMIN
/
REVOKE SELECT ANY DICTIONARY FROM SYSADM

/



***********DPPPRD01*****


CREATE USER ext$BATCHMGR IDENTIFIED EXTERNALLY
    DEFAULT TABLESPACE USERS
    TEMPORARY TABLESPACE TEMP
    PROFILE TRUSTED_ID_NO_EXPIRE
    ACCOUNT UNLOCK
/
GRANT PSOPSBATCHMGR TO ext$BATCHMGR
/
GRANT PSUSER TO ext$BATCHMGR
/
ALTER USER ext$BATCHMGR DEFAULT ROLE PSOPSBATCHMGR,
                                     PSUSER
/
CREATE USER ext$DPPXFNCL IDENTIFIED EXTERNALLY
    DEFAULT TABLESPACE USERS
    TEMPORARY TABLESPACE TEMP
    PROFILE TRUSTED_ID_NO_EXPIRE
    ACCOUNT UNLOCK
/
GRANT PSOPSBATCHMGR TO ext$DPPXFNCL
/
GRANT PSUSER TO ext$DPPXFNCL
/
ALTER USER ext$DPPXFNCL DEFAULT ROLE PSOPSBATCHMGR,
                                     PSUSER
/
CREATE USER ext$ORACLE IDENTIFIED EXTERNALLY
    DEFAULT TABLESPACE USERS
    TEMPORARY TABLESPACE TEMP
    PROFILE TRUSTED_ID_NO_EXPIRE
    ACCOUNT UNLOCK
/
GRANT "CONNECT" TO ext$ORACLE
/
GRANT DBA TO ext$ORACLE
/
ALTER USER ext$ORACLE DEFAULT ROLE "CONNECT",
                                   DBA
/
GRANT UNLIMITED TABLESPACE TO ext$ORACLE
/







REVOKE ANALYZE ANY FROM DPADMIN
/
REVOKE SELECT ANY DICTIONARY FROM SYSADM

/



***********DPPPRD02*****


CREATE USER ext$BATCHMGR IDENTIFIED EXTERNALLY
    DEFAULT TABLESPACE USERS
    TEMPORARY TABLESPACE TEMP
    PROFILE TRUSTED_ID_NO_EXPIRE
    ACCOUNT UNLOCK
/
GRANT PSOPSBATCHMGR TO ext$BATCHMGR
/
GRANT PSUSER TO ext$BATCHMGR
/
ALTER USER ext$BATCHMGR DEFAULT ROLE PSOPSBATCHMGR,
                                     PSUSER
/
CREATE USER ext$DPPXFNCL IDENTIFIED EXTERNALLY
    DEFAULT TABLESPACE USERS
    TEMPORARY TABLESPACE TEMP
    PROFILE TRUSTED_ID_NO_EXPIRE
    ACCOUNT UNLOCK
/
GRANT PSOPSBATCHMGR TO ext$DPPXFNCL
/
GRANT PSUSER TO ext$DPPXFNCL
/
ALTER USER ext$DPPXFNCL DEFAULT ROLE PSOPSBATCHMGR,
                                     PSUSER
/
CREATE USER ext$ORACLE IDENTIFIED EXTERNALLY
    DEFAULT TABLESPACE USERS
    TEMPORARY TABLESPACE TEMP
    PROFILE TRUSTED_ID_NO_EXPIRE
    ACCOUNT UNLOCK
/
GRANT "CONNECT" TO ext$ORACLE
/
GRANT DBA TO ext$ORACLE
/
ALTER USER ext$ORACLE DEFAULT ROLE "CONNECT",
                                   DBA
/
GRANT UNLIMITED TABLESPACE TO ext$ORACLE
/







REVOKE ANALYZE ANY FROM DPADMIN
/

GRANT ANALYZE ANY TO DPADMIN
/

REVOKE SELECT ANY DICTIONARY FROM SYSADM

/

