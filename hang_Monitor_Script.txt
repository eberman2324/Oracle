   select  'PARAMETERS' as ROWFLAG,
                sum(case
                       when status='ACTIVE'
                        and program='w3wp.exe'
                        and last_call_et > 300
                       then 1
                       else 0
                    end
                   ) as long_running_queries,
                 sum(case
                       when status='ACTIVE'
                        and sql_id='d5fk4s1n4rfwj'
                        and last_call_et > 30
                       then 1
                       else 0
                    end
                   ) as long_mutex_query,
                sum(case
                       when status='ACTIVE'
                        and event='library cache: mutex X'
                        and last_call_et > 30
                       then 1
                       else 0
                    end) as sessions_waiting_on_mutex
     from v\$session s,
             audit_actions aa
    where s.command = aa.action
      and s.status = 'ACTIVE'
      and s.type <> 'BACKGROUND'
      and s.event not in ('jobq slave wait', 'rdbms ipc message')
      and s.event not like 'Streams AQ:%'
   /
   spool off
   EOF
   if [ $? -ne 0 ]
   then
      log_message "Error running check sql"
      return 2
   fi

   LONG_QUERY=`awk '/PARAMETERS/ {print $2}' $PARAMETER_TEMP`
   LONG_MUTEX_QUERY=`awk '/PARAMETERS/ {print $3}' $PARAMETER_TEMP`
   SESSIONS_WAITING_ON_MUTEX=`awk '/PARAMETERS/ {print $4}' $PARAMETER_TEMP`

   log_message "long_query=$LONG_QUERY"
                       then 1
                       else 0
                    end
                   ) as long_mutex_query,
                sum(case
                       when status='ACTIVE'
                        and event='library cache: mutex X'
                        and last_call_et > 30
                       then 1
                       else 0
                    end) as sessions_waiting_on_mutex
     from v\$session s,
             audit_actions aa
    where s.command = aa.action
      and s.status = 'ACTIVE'
      and s.type <> 'BACKGROUND'
      and s.event not in ('jobq slave wait', 'rdbms ipc message')
      and s.event not like 'Streams AQ:%'
   /